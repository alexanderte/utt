<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf8">
  </head>
  <body>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.4.2/underscore-min.js"></script>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/backbone.js/0.9.2/backbone-min.js"></script>
    <script>
      var B = Backbone;

      var Test = B.Model.extend({
        defaults: {
          'title': undefined,
          'question': undefined,
          'answers': ['Yes', 'No', 'Unsure'],
          'template': 'test-case-template',
          'result': { 'answer': undefined, 'comment': '' }
        }
      });

      var Tests = B.Collection.extend({
        model: Test
      });

      var tests = new Tests([
        {
          title: 'Foo appropriate for this page?',
          question: 'Is foo appropriate for this page?',
        },
        {
          title: 'Foo appropriate for this page?',
          question: 'Is bar appropriate for this page?',
        },
        {
          title: 'Foo appropriate for this page?',
          question: 'Is baz appropriate for this page?',
        },
      ]);

      var TestRun = B.Model.extend({
        defaults: {
          'webPage': 'http://www.tingtun.no/',
          'currentTest': 0,
          'tests': tests
        },
        progress: function() {
          console.log(
            parseInt(
              (this.get('currentTest') / this.get('tests').length) * 100));
        },
        previousTest: function() {
          if (this.get('currentTest') === 0)
            return false;

          this.set('currentTest', this.get('currentTest') - 1);
          return true;
        },
        nextTest: function() {
          if (this.get('currentTest') === this.get('tests').length)
            return false;

          this.set('currentTest', this.get('currentTest') + 1);
          return true;
        }
      });

      var testRun = new TestRun();

      do {
        testRun.progress();
      }
      while (testRun.nextTest() === true);

      do {
        testRun.progress();
      }
      while (testRun.previousTest() === true);
    </script>
  </body>
</html>
